/*! For license information please see index.js.LICENSE.txt */
(()=>{var t={103(t,e,s){"use strict";s.r(e),s.d(e,{VERSION:()=>n,retry:()=>h});var r=s(454);class i extends Error{name;status;request;response;constructor(t,e,s){super(t,{cause:s.cause}),this.name="HttpError",this.status=Number.parseInt(e),Number.isNaN(this.status)&&(this.status=0),"response"in s&&(this.response=s.response);const r=Object.assign({},s.request);s.request.headers.authorization&&(r.headers=Object.assign({},s.request.headers,{authorization:s.request.headers.authorization.replace(/(?<! ) .*$/," [REDACTED]")})),r.url=r.url.replace(/\bclient_secret=\w+/g,"client_secret=[REDACTED]").replace(/\baccess_token=\w+/g,"access_token=[REDACTED]"),this.request=r}}var n="0.0.0-development";async function o(t,e,s,r){if(!s.request||!s.request.request)throw s;if(s.status>=400&&!t.doNotRetry.includes(s.status)){const i=null!=r.request.retries?r.request.retries:t.retries,n=Math.pow((r.request.retryCount||0)+1,2);throw e.retry.retryRequest(s,i,n)}throw s}async function a(t,e,s,i){const n=new r;return n.on("failed",function(e,s){const r=~~e.request.request.retries,n=~~e.request.request.retryAfter;if(i.request.retryCount=s.retryCount+1,r>s.retryCount)return n*t.retryAfterBaseValue}),n.schedule(u.bind(null,t,e,s),i)}async function u(t,e,s,r){const n=await s(s,r);return n.data&&n.data.errors&&n.data.errors.length>0&&/Something went wrong while executing your query/.test(n.data.errors[0].message)?o(t,e,new i(n.data.errors[0].message,500,{request:r,response:n}),r):n}function h(t,e){const s=Object.assign({enabled:!0,retryAfterBaseValue:1e3,doNotRetry:[400,401,403,404,410,422,451],retries:3},e.retry);return s.enabled&&(t.hook.error("request",o.bind(null,s,t)),t.hook.wrap("request",a.bind(null,s,t))),{retry:{retryRequest:(t,e,s)=>(t.request.request=Object.assign({},t.request.request,{retries:e,retryAfter:s}),t)}}}h.VERSION=n},407(t,e){e.validateImagesArray=function(t){const e=[];return Array.isArray(t)?(t.forEach((t,s)=>{"object"==typeof t&&null!==t?(Object.prototype.hasOwnProperty.call(t,"alt")&&"string"==typeof t.alt||e.push(`Item at index ${s} has an invalid 'alt'`),Object.prototype.hasOwnProperty.call(t,"image_url")&&"string"==typeof t.image_url||e.push(`Item at index ${s} has an invalid 'image_url'`),Object.prototype.hasOwnProperty.call(t,"caption")&&"string"!=typeof t.caption&&e.push(`Item at index ${s} has an invalid 'caption'`)):e.push(`Item at index ${s} is not an object`)}),e):(e.push("Payload is not an array"),e)}},453(t){"use strict";t.exports=require("@actions/core")},454(t){var e;e=function(){"use strict";var t,e,s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},r={load:function(t,e,s={}){var r,i,n;for(r in e)n=e[r],s[r]=null!=(i=t[r])?i:n;return s},overwrite:function(t,e,s={}){var r,i;for(r in t)i=t[r],void 0!==e[r]&&(s[r]=i);return s}},i=class{constructor(t,e){this.incr=t,this.decr=e,this._first=null,this._last=null,this.length=0}push(t){var e;this.length++,"function"==typeof this.incr&&this.incr(),e={value:t,prev:this._last,next:null},null!=this._last?(this._last.next=e,this._last=e):this._first=this._last=e}shift(){var t;if(null!=this._first)return this.length--,"function"==typeof this.decr&&this.decr(),t=this._first.value,null!=(this._first=this._first.next)?this._first.prev=null:this._last=null,t}first(){if(null!=this._first)return this._first.value}getArray(){var t,e,s;for(t=this._first,s=[];null!=t;)s.push((e=t,t=t.next,e.value));return s}forEachShift(t){var e;for(e=this.shift();null!=e;)t(e),e=this.shift()}debug(){var t,e,s,r,i;for(t=this._first,i=[];null!=t;)i.push((e=t,t=t.next,{value:e.value,prev:null!=(s=e.prev)?s.value:void 0,next:null!=(r=e.next)?r.value:void 0}));return i}},n=class{constructor(t){if(this.instance=t,this._events={},null!=this.instance.on||null!=this.instance.once||null!=this.instance.removeAllListeners)throw new Error("An Emitter already exists for this object");this.instance.on=(t,e)=>this._addListener(t,"many",e),this.instance.once=(t,e)=>this._addListener(t,"once",e),this.instance.removeAllListeners=(t=null)=>null!=t?delete this._events[t]:this._events={}}_addListener(t,e,s){var r;return null==(r=this._events)[t]&&(r[t]=[]),this._events[t].push({cb:s,status:e}),this.instance}listenerCount(t){return null!=this._events[t]?this._events[t].length:0}async trigger(t,...e){var s,r;try{if("debug"!==t&&this.trigger("debug",`Event triggered: ${t}`,e),null==this._events[t])return;return this._events[t]=this._events[t].filter(function(t){return"none"!==t.status}),r=this._events[t].map(async t=>{var s,r;if("none"!==t.status){"once"===t.status&&(t.status="none");try{return"function"==typeof(null!=(r="function"==typeof t.cb?t.cb(...e):void 0)?r.then:void 0)?await r:r}catch(t){return s=t,this.trigger("error",s),null}}}),(await Promise.all(r)).find(function(t){return null!=t})}catch(t){return s=t,this.trigger("error",s),null}}};t=i,e=n;var o,a,u,h=class extends Error{};u=r,o=h,a=class{constructor(t,e,s,r,i,n,o,a){this.task=t,this.args=e,this.rejectOnDrop=i,this.Events=n,this._states=o,this.Promise=a,this.options=u.load(s,r),this.options.priority=this._sanitizePriority(this.options.priority),this.options.id===r.id&&(this.options.id=`${this.options.id}-${this._randomIndex()}`),this.promise=new this.Promise((t,e)=>{this._resolve=t,this._reject=e}),this.retryCount=0}_sanitizePriority(t){var e;return(e=~~t!==t?5:t)<0?0:e>9?9:e}_randomIndex(){return Math.random().toString(36).slice(2)}doDrop({error:t,message:e="This job has been dropped by Bottleneck"}={}){return!!this._states.remove(this.options.id)&&(this.rejectOnDrop&&this._reject(null!=t?t:new o(e)),this.Events.trigger("dropped",{args:this.args,options:this.options,task:this.task,promise:this.promise}),!0)}_assertStatus(t){var e;if((e=this._states.jobStatus(this.options.id))!==t&&("DONE"!==t||null!==e))throw new o(`Invalid job status ${e}, expected ${t}. Please open an issue at https://github.com/SGrondin/bottleneck/issues`)}doReceive(){return this._states.start(this.options.id),this.Events.trigger("received",{args:this.args,options:this.options})}doQueue(t,e){return this._assertStatus("RECEIVED"),this._states.next(this.options.id),this.Events.trigger("queued",{args:this.args,options:this.options,reachedHWM:t,blocked:e})}doRun(){return 0===this.retryCount?(this._assertStatus("QUEUED"),this._states.next(this.options.id)):this._assertStatus("EXECUTING"),this.Events.trigger("scheduled",{args:this.args,options:this.options})}async doExecute(t,e,s,r){var i,n,o;0===this.retryCount?(this._assertStatus("RUNNING"),this._states.next(this.options.id)):this._assertStatus("EXECUTING"),n={args:this.args,options:this.options,retryCount:this.retryCount},this.Events.trigger("executing",n);try{if(o=await(null!=t?t.schedule(this.options,this.task,...this.args):this.task(...this.args)),e())return this.doDone(n),await r(this.options,n),this._assertStatus("DONE"),this._resolve(o)}catch(t){return i=t,this._onFailure(i,n,e,s,r)}}doExpire(t,e,s){var r,i;return this._states.jobStatus("RUNNING"===this.options.id)&&this._states.next(this.options.id),this._assertStatus("EXECUTING"),i={args:this.args,options:this.options,retryCount:this.retryCount},r=new o(`This job timed out after ${this.options.expiration} ms.`),this._onFailure(r,i,t,e,s)}async _onFailure(t,e,s,r,i){var n,o;if(s())return null!=(n=await this.Events.trigger("failed",t,e))?(o=~~n,this.Events.trigger("retry",`Retrying ${this.options.id} after ${o} ms`,e),this.retryCount++,r(o)):(this.doDone(e),await i(this.options,e),this._assertStatus("DONE"),this._reject(t))}doDone(t){return this._assertStatus("EXECUTING"),this._states.next(this.options.id),this.Events.trigger("done",t)}};var l,c,d=a;c=r,l=h;var p;p=h;var _;_=i;var m,g,f,v,y,w="2.19.5",b={version:w},E=Object.freeze({version:w,default:b}),O=()=>console.log("You must import the full version of Bottleneck in order to use this feature."),k=()=>console.log("You must import the full version of Bottleneck in order to use this feature.");y=r,m=n,f=O,g=k,v=()=>console.log("You must import the full version of Bottleneck in order to use this feature.");var R,I,x=function(){class t{constructor(t={}){this.deleteKey=this.deleteKey.bind(this),this.limiterOptions=t,y.load(this.limiterOptions,this.defaults,this),this.Events=new m(this),this.instances={},this.Bottleneck=B,this._startAutoCleanup(),this.sharedConnection=null!=this.connection,null==this.connection&&("redis"===this.limiterOptions.datastore?this.connection=new f(Object.assign({},this.limiterOptions,{Events:this.Events})):"ioredis"===this.limiterOptions.datastore&&(this.connection=new g(Object.assign({},this.limiterOptions,{Events:this.Events}))))}key(t=""){var e;return null!=(e=this.instances[t])?e:(()=>{var e;return e=this.instances[t]=new this.Bottleneck(Object.assign(this.limiterOptions,{id:`${this.id}-${t}`,timeout:this.timeout,connection:this.connection})),this.Events.trigger("created",e,t),e})()}async deleteKey(t=""){var e,s;return s=this.instances[t],this.connection&&(e=await this.connection.__runCommand__(["del",...v.allKeys(`${this.id}-${t}`)])),null!=s&&(delete this.instances[t],await s.disconnect()),null!=s||e>0}limiters(){var t,e,s,r;for(t in s=[],e=this.instances)r=e[t],s.push({key:t,limiter:r});return s}keys(){return Object.keys(this.instances)}async clusterKeys(){var t,e,s,r,i,n,o,a;if(null==this.connection)return this.Promise.resolve(this.keys());for(i=[],t=null,a=`b_${this.id}-`.length;0!==t;)for([o,e]=await this.connection.__runCommand__(["scan",null!=t?t:0,"match",`b_${this.id}-*_settings`,"count",1e4]),t=~~o,s=0,n=e.length;s<n;s++)r=e[s],i.push(r.slice(a,-9));return i}_startAutoCleanup(){var t;return clearInterval(this.interval),"function"==typeof(t=this.interval=setInterval(async()=>{var t,e,s,r,i,n;for(e in i=Date.now(),r=[],s=this.instances){n=s[e];try{await n._store.__groupCheck__(i)?r.push(this.deleteKey(e)):r.push(void 0)}catch(e){t=e,r.push(n.Events.trigger("error",t))}}return r},this.timeout/2)).unref?t.unref():void 0}updateSettings(t={}){if(y.overwrite(t,this.defaults,this),y.overwrite(t,t,this.limiterOptions),null!=t.timeout)return this._startAutoCleanup()}disconnect(t=!0){var e;if(!this.sharedConnection)return null!=(e=this.connection)?e.disconnect(t):void 0}}return t.prototype.defaults={timeout:3e5,connection:null,Promise,id:"group-key"},t}.call(s);I=r,R=n;var q,j,C,A,D,S,T,L,P,$=function(){class t{constructor(t={}){this.options=t,I.load(this.options,this.defaults,this),this.Events=new R(this),this._arr=[],this._resetPromise(),this._lastFlush=Date.now()}_resetPromise(){return this._promise=new this.Promise((t,e)=>this._resolve=t)}_flush(){return clearTimeout(this._timeout),this._lastFlush=Date.now(),this._resolve(),this.Events.trigger("batch",this._arr),this._arr=[],this._resetPromise()}add(t){var e;return this._arr.push(t),e=this._promise,this._arr.length===this.maxSize?this._flush():null!=this.maxTime&&1===this._arr.length&&(this._timeout=setTimeout(()=>this._flush(),this.maxTime)),e}}return t.prototype.defaults={maxTime:null,maxSize:null,Promise},t}.call(s),G=(q=E)&&q.default||q,N=[].splice;P=r,D=class{constructor(s){this.Events=new e(this),this._length=0,this._lists=function(){var e,r,i;for(i=[],e=1,r=s;1<=r?e<=r:e>=r;1<=r?++e:--e)i.push(new t(()=>this.incr(),()=>this.decr()));return i}.call(this)}incr(){if(0===this._length++)return this.Events.trigger("leftzero")}decr(){if(0===--this._length)return this.Events.trigger("zero")}push(t){return this._lists[t.options.priority].push(t)}queued(t){return null!=t?this._lists[t].length:this._length}shiftAll(t){return this._lists.forEach(function(e){return e.forEachShift(t)})}getFirst(t=this._lists){var e,s,r;for(e=0,s=t.length;e<s;e++)if((r=t[e]).length>0)return r;return[]}shiftLastFrom(t){return this.getFirst(this._lists.slice(t).reverse()).shift()}},C=d,A=class{constructor(t,e,s){this.instance=t,this.storeOptions=e,this.clientId=this.instance._randomIndex(),c.load(s,s,this),this._nextRequest=this._lastReservoirRefresh=this._lastReservoirIncrease=Date.now(),this._running=0,this._done=0,this._unblockTime=0,this.ready=this.Promise.resolve(),this.clients={},this._startHeartbeat()}_startHeartbeat(){var t;return null==this.heartbeat&&(null!=this.storeOptions.reservoirRefreshInterval&&null!=this.storeOptions.reservoirRefreshAmount||null!=this.storeOptions.reservoirIncreaseInterval&&null!=this.storeOptions.reservoirIncreaseAmount)?"function"==typeof(t=this.heartbeat=setInterval(()=>{var t,e,s,r,i;if(r=Date.now(),null!=this.storeOptions.reservoirRefreshInterval&&r>=this._lastReservoirRefresh+this.storeOptions.reservoirRefreshInterval&&(this._lastReservoirRefresh=r,this.storeOptions.reservoir=this.storeOptions.reservoirRefreshAmount,this.instance._drainAll(this.computeCapacity())),null!=this.storeOptions.reservoirIncreaseInterval&&r>=this._lastReservoirIncrease+this.storeOptions.reservoirIncreaseInterval&&(({reservoirIncreaseAmount:t,reservoirIncreaseMaximum:s,reservoir:i}=this.storeOptions),this._lastReservoirIncrease=r,(e=null!=s?Math.min(t,s-i):t)>0))return this.storeOptions.reservoir+=e,this.instance._drainAll(this.computeCapacity())},this.heartbeatInterval)).unref?t.unref():void 0:clearInterval(this.heartbeat)}async __publish__(t){return await this.yieldLoop(),this.instance.Events.trigger("message",t.toString())}async __disconnect__(t){return await this.yieldLoop(),clearInterval(this.heartbeat),this.Promise.resolve()}yieldLoop(t=0){return new this.Promise(function(e,s){return setTimeout(e,t)})}computePenalty(){var t;return null!=(t=this.storeOptions.penalty)?t:15*this.storeOptions.minTime||5e3}async __updateSettings__(t){return await this.yieldLoop(),c.overwrite(t,t,this.storeOptions),this._startHeartbeat(),this.instance._drainAll(this.computeCapacity()),!0}async __running__(){return await this.yieldLoop(),this._running}async __queued__(){return await this.yieldLoop(),this.instance.queued()}async __done__(){return await this.yieldLoop(),this._done}async __groupCheck__(t){return await this.yieldLoop(),this._nextRequest+this.timeout<t}computeCapacity(){var t,e;return({maxConcurrent:t,reservoir:e}=this.storeOptions),null!=t&&null!=e?Math.min(t-this._running,e):null!=t?t-this._running:null!=e?e:null}conditionsCheck(t){var e;return null==(e=this.computeCapacity())||t<=e}async __incrementReservoir__(t){var e;return await this.yieldLoop(),e=this.storeOptions.reservoir+=t,this.instance._drainAll(this.computeCapacity()),e}async __currentReservoir__(){return await this.yieldLoop(),this.storeOptions.reservoir}isBlocked(t){return this._unblockTime>=t}check(t,e){return this.conditionsCheck(t)&&this._nextRequest-e<=0}async __check__(t){var e;return await this.yieldLoop(),e=Date.now(),this.check(t,e)}async __register__(t,e,s){var r,i;return await this.yieldLoop(),r=Date.now(),this.conditionsCheck(e)?(this._running+=e,null!=this.storeOptions.reservoir&&(this.storeOptions.reservoir-=e),i=Math.max(this._nextRequest-r,0),this._nextRequest=r+i+this.storeOptions.minTime,{success:!0,wait:i,reservoir:this.storeOptions.reservoir}):{success:!1}}strategyIsBlock(){return 3===this.storeOptions.strategy}async __submit__(t,e){var s,r,i;if(await this.yieldLoop(),null!=this.storeOptions.maxConcurrent&&e>this.storeOptions.maxConcurrent)throw new l(`Impossible to add a job having a weight of ${e} to a limiter having a maxConcurrent setting of ${this.storeOptions.maxConcurrent}`);return r=Date.now(),i=null!=this.storeOptions.highWater&&t===this.storeOptions.highWater&&!this.check(e,r),(s=this.strategyIsBlock()&&(i||this.isBlocked(r)))&&(this._unblockTime=r+this.computePenalty(),this._nextRequest=this._unblockTime+this.storeOptions.minTime,this.instance._dropAllQueued()),{reachedHWM:i,blocked:s,strategy:this.storeOptions.strategy}}async __free__(t,e){return await this.yieldLoop(),this._running-=e,this._done+=e,this.instance._drainAll(this.computeCapacity()),{running:this._running}}},S=()=>console.log("You must import the full version of Bottleneck in order to use this feature."),j=n,T=class{constructor(t){this.status=t,this._jobs={},this.counts=this.status.map(function(){return 0})}next(t){var e,s;return s=(e=this._jobs[t])+1,null!=e&&s<this.status.length?(this.counts[e]--,this.counts[s]++,this._jobs[t]++):null!=e?(this.counts[e]--,delete this._jobs[t]):void 0}start(t){return this._jobs[t]=0,this.counts[0]++}remove(t){var e;return null!=(e=this._jobs[t])&&(this.counts[e]--,delete this._jobs[t]),null!=e}jobStatus(t){var e;return null!=(e=this.status[this._jobs[t]])?e:null}statusJobs(t){var e,s,r,i;if(null!=t){if((s=this.status.indexOf(t))<0)throw new p(`status must be one of ${this.status.join(", ")}`);for(e in i=[],r=this._jobs)r[e]===s&&i.push(e);return i}return Object.keys(this._jobs)}statusCounts(){return this.counts.reduce((t,e,s)=>(t[this.status[s]]=e,t),{})}},L=class{constructor(t,e){this.schedule=this.schedule.bind(this),this.name=t,this.Promise=e,this._running=0,this._queue=new _}isEmpty(){return 0===this._queue.length}async _tryToRun(){var t,e,s,r,i,n,o;if(this._running<1&&this._queue.length>0)return this._running++,({task:o,args:t,resolve:i,reject:r}=this._queue.shift()),e=await async function(){try{return n=await o(...t),function(){return i(n)}}catch(t){return s=t,function(){return r(s)}}}(),this._running--,this._tryToRun(),e()}schedule(t,...e){var s,r,i;return i=r=null,s=new this.Promise(function(t,e){return i=t,r=e}),this._queue.push({task:t,args:e,resolve:i,reject:r}),this._tryToRun(),s}};var B=function(){class t{constructor(e={},...s){var r,i;this._addToQueue=this._addToQueue.bind(this),this._validateOptions(e,s),P.load(e,this.instanceDefaults,this),this._queues=new D(10),this._scheduled={},this._states=new T(["RECEIVED","QUEUED","RUNNING","EXECUTING"].concat(this.trackDoneStatus?["DONE"]:[])),this._limiter=null,this.Events=new j(this),this._submitLock=new L("submit",this.Promise),this._registerLock=new L("register",this.Promise),i=P.load(e,this.storeDefaults,{}),this._store=function(){if("redis"===this.datastore||"ioredis"===this.datastore||null!=this.connection)return r=P.load(e,this.redisStoreDefaults,{}),new S(this,i,r);if("local"===this.datastore)return r=P.load(e,this.localStoreDefaults,{}),new A(this,i,r);throw new t.prototype.BottleneckError(`Invalid datastore type: ${this.datastore}`)}.call(this),this._queues.on("leftzero",()=>{var t;return null!=(t=this._store.heartbeat)&&"function"==typeof t.ref?t.ref():void 0}),this._queues.on("zero",()=>{var t;return null!=(t=this._store.heartbeat)&&"function"==typeof t.unref?t.unref():void 0})}_validateOptions(e,s){if(null==e||"object"!=typeof e||0!==s.length)throw new t.prototype.BottleneckError("Bottleneck v2 takes a single object argument. Refer to https://github.com/SGrondin/bottleneck#upgrading-to-v2 if you're upgrading from Bottleneck v1.")}ready(){return this._store.ready}clients(){return this._store.clients}channel(){return`b_${this.id}`}channel_client(){return`b_${this.id}_${this._store.clientId}`}publish(t){return this._store.__publish__(t)}disconnect(t=!0){return this._store.__disconnect__(t)}chain(t){return this._limiter=t,this}queued(t){return this._queues.queued(t)}clusterQueued(){return this._store.__queued__()}empty(){return 0===this.queued()&&this._submitLock.isEmpty()}running(){return this._store.__running__()}done(){return this._store.__done__()}jobStatus(t){return this._states.jobStatus(t)}jobs(t){return this._states.statusJobs(t)}counts(){return this._states.statusCounts()}_randomIndex(){return Math.random().toString(36).slice(2)}check(t=1){return this._store.__check__(t)}_clearGlobalState(t){return null!=this._scheduled[t]&&(clearTimeout(this._scheduled[t].expiration),delete this._scheduled[t],!0)}async _free(t,e,s,r){var i,n;try{if(({running:n}=await this._store.__free__(t,s.weight)),this.Events.trigger("debug",`Freed ${s.id}`,r),0===n&&this.empty())return this.Events.trigger("idle")}catch(t){return i=t,this.Events.trigger("error",i)}}_run(t,e,s){var r,i,n;return e.doRun(),r=this._clearGlobalState.bind(this,t),n=this._run.bind(this,t,e),i=this._free.bind(this,t,e),this._scheduled[t]={timeout:setTimeout(()=>e.doExecute(this._limiter,r,n,i),s),expiration:null!=e.options.expiration?setTimeout(function(){return e.doExpire(r,n,i)},s+e.options.expiration):void 0,job:e}}_drainOne(t){return this._registerLock.schedule(()=>{var e,s,r,i,n;return 0===this.queued()?this.Promise.resolve(null):(n=this._queues.getFirst(),({options:i,args:e}=r=n.first()),null!=t&&i.weight>t?this.Promise.resolve(null):(this.Events.trigger("debug",`Draining ${i.id}`,{args:e,options:i}),s=this._randomIndex(),this._store.__register__(s,i.weight,i.expiration).then(({success:t,wait:o,reservoir:a})=>{var u;return this.Events.trigger("debug",`Drained ${i.id}`,{success:t,args:e,options:i}),t?(n.shift(),(u=this.empty())&&this.Events.trigger("empty"),0===a&&this.Events.trigger("depleted",u),this._run(s,r,o),this.Promise.resolve(i.weight)):this.Promise.resolve(null)})))})}_drainAll(t,e=0){return this._drainOne(t).then(s=>{var r;return null!=s?(r=null!=t?t-s:t,this._drainAll(r,e+s)):this.Promise.resolve(e)}).catch(t=>this.Events.trigger("error",t))}_dropAllQueued(t){return this._queues.shiftAll(function(e){return e.doDrop({message:t})})}stop(e={}){var s,r;return e=P.load(e,this.stopDefaults),r=t=>{var e;return e=()=>{var e;return(e=this._states.counts)[0]+e[1]+e[2]+e[3]===t},new this.Promise((t,s)=>e()?t():this.on("done",()=>{if(e())return this.removeAllListeners("done"),t()}))},s=e.dropWaitingJobs?(this._run=function(t,s){return s.doDrop({message:e.dropErrorMessage})},this._drainOne=()=>this.Promise.resolve(null),this._registerLock.schedule(()=>this._submitLock.schedule(()=>{var t,s,i;for(t in s=this._scheduled)i=s[t],"RUNNING"===this.jobStatus(i.job.options.id)&&(clearTimeout(i.timeout),clearTimeout(i.expiration),i.job.doDrop({message:e.dropErrorMessage}));return this._dropAllQueued(e.dropErrorMessage),r(0)}))):this.schedule({priority:9,weight:0},()=>r(1)),this._receive=function(s){return s._reject(new t.prototype.BottleneckError(e.enqueueErrorMessage))},this.stop=()=>this.Promise.reject(new t.prototype.BottleneckError("stop() has already been called")),s}async _addToQueue(e){var s,r,i,n,o,a,u;({args:s,options:n}=e);try{({reachedHWM:o,blocked:r,strategy:u}=await this._store.__submit__(this.queued(),n.weight))}catch(t){return i=t,this.Events.trigger("debug",`Could not queue ${n.id}`,{args:s,options:n,error:i}),e.doDrop({error:i}),!1}return r?(e.doDrop(),!0):o&&(null!=(a=u===t.prototype.strategy.LEAK?this._queues.shiftLastFrom(n.priority):u===t.prototype.strategy.OVERFLOW_PRIORITY?this._queues.shiftLastFrom(n.priority+1):u===t.prototype.strategy.OVERFLOW?e:void 0)&&a.doDrop(),null==a||u===t.prototype.strategy.OVERFLOW)?(null==a&&e.doDrop(),o):(e.doQueue(o,r),this._queues.push(e),await this._drainAll(),o)}_receive(e){return null!=this._states.jobStatus(e.options.id)?(e._reject(new t.prototype.BottleneckError(`A job with the same id already exists (id=${e.options.id})`)),!1):(e.doReceive(),this._submitLock.schedule(this._addToQueue,e))}submit(...t){var e,s,r,i,n,o,a;return"function"==typeof t[0]?(n=t,[s,...t]=n,[e]=N.call(t,-1),i=P.load({},this.jobDefaults)):(o=t,[i,s,...t]=o,[e]=N.call(t,-1),i=P.load(i,this.jobDefaults)),a=(...t)=>new this.Promise(function(e,r){return s(...t,function(...t){return(null!=t[0]?r:e)(t)})}),(r=new C(a,t,i,this.jobDefaults,this.rejectOnDrop,this.Events,this._states,this.Promise)).promise.then(function(t){return"function"==typeof e?e(...t):void 0}).catch(function(t){return Array.isArray(t)?"function"==typeof e?e(...t):void 0:"function"==typeof e?e(t):void 0}),this._receive(r)}schedule(...t){var e,s,r;return"function"==typeof t[0]?([r,...t]=t,s={}):[s,r,...t]=t,e=new C(r,t,s,this.jobDefaults,this.rejectOnDrop,this.Events,this._states,this.Promise),this._receive(e),e.promise}wrap(t){var e,s;return e=this.schedule.bind(this),(s=function(...s){return e(t.bind(this),...s)}).withOptions=function(s,...r){return e(s,t,...r)},s}async updateSettings(t={}){return await this._store.__updateSettings__(P.overwrite(t,this.storeDefaults)),P.overwrite(t,this.instanceDefaults,this),this}currentReservoir(){return this._store.__currentReservoir__()}incrementReservoir(t=0){return this._store.__incrementReservoir__(t)}}return t.default=t,t.Events=j,t.version=t.prototype.version=G.version,t.strategy=t.prototype.strategy={LEAK:1,OVERFLOW:2,OVERFLOW_PRIORITY:4,BLOCK:3},t.BottleneckError=t.prototype.BottleneckError=h,t.Group=t.prototype.Group=x,t.RedisConnection=t.prototype.RedisConnection=O,t.IORedisConnection=t.prototype.IORedisConnection=k,t.Batcher=t.prototype.Batcher=$,t.prototype.jobDefaults={priority:5,weight:1,expiration:null,id:"<no-id>"},t.prototype.storeDefaults={maxConcurrent:null,minTime:0,highWater:null,strategy:t.prototype.strategy.LEAK,penalty:null,reservoir:null,reservoirRefreshInterval:null,reservoirRefreshAmount:null,reservoirIncreaseInterval:null,reservoirIncreaseAmount:null,reservoirIncreaseMaximum:null},t.prototype.localStoreDefaults={Promise,timeout:null,heartbeatInterval:250},t.prototype.redisStoreDefaults={Promise,timeout:null,heartbeatInterval:5e3,clientTimeout:1e4,Redis:null,clientOptions:{},clusterNodes:null,clearDatastore:!1,connection:null},t.prototype.instanceDefaults={datastore:"local",connection:null,id:"<no-id>",rejectOnDrop:!0,trackDoneStatus:!1,Promise},t.prototype.stopDefaults={enqueueErrorMessage:"This limiter has been stopped and cannot accept new jobs.",dropWaitingJobs:!0,dropErrorMessage:"This limiter has been stopped."},t}.call(s);return B},t.exports=e()},677(t,e){e.validateAnnotationsArray=function(t){const e=[];return Array.isArray(t)?(t.forEach((t,s)=>{"string"!=typeof t.path&&e.push(`Item at index ${s} has an invalid 'path'`),("number"!=typeof t.start_line||t.start_line<1)&&e.push(`Item at index ${s} has an invalid 'start_line'`),("number"!=typeof t.end_line||t.end_line<t.start_line)&&e.push(`Item at index ${s} has an invalid 'end_line'`),void 0!==t.start_column&&("number"!=typeof t.start_column||t.start_column<1)&&e.push(`Item at index ${s} has an invalid 'start_column'`),void 0!==t.end_column&&("number"!=typeof t.end_column||t.end_column<1)&&e.push(`Item at index ${s} has an invalid 'end_column'`),-1===["notice","warning","failure"].indexOf(t.annotation_level)&&e.push(`Item at index ${s} has an invalid 'annotation_level'`),"string"!=typeof t.message&&e.push(`Item at index ${s} has an invalid 'message'`),void 0!==t.title&&"string"!=typeof t.title&&e.push(`Item at index ${s} has an invalid 'title'`),void 0!==t.raw_details&&"string"!=typeof t.raw_details&&e.push(`Item at index ${s} has an invalid 'raw_details'`)}),e):(e.push("Payload is not an array"),e)}},733(t){"use strict";t.exports=require("@actions/github")},763(t,e,s){"use strict";s.r(e),s.d(e,{throttling:()=>l});var r=s(454),i=()=>Promise.resolve();function n(t,e,s){return t.retryLimiter.schedule(o,t,e,s)}async function o(t,e,s){const{pathname:r}=new URL(s.url,"http://github.test"),n=function(t,e){return"PATCH"===t&&/^\/applications\/[^/]+\/token\/scoped$/.test(e)||"POST"===t&&(/^\/applications\/[^/]+\/token$/.test(e)||/^\/app\/installations\/[^/]+\/access_tokens$/.test(e)||"/login/oauth/access_token"===e)}(s.method,r),o=!n&&"GET"!==s.method&&"HEAD"!==s.method,a="GET"===s.method&&r.startsWith("/search/"),u=r.startsWith("/graphql"),h=~~e.retryCount>0?{priority:0,weight:0}:{};t.clustering&&(h.expiration=6e4),(o||u)&&await t.write.key(t.id).schedule(h,i),o&&t.triggersNotification(r)&&await t.notifications.key(t.id).schedule(h,i),a&&await t.search.key(t.id).schedule(h,i);const l=(n?t.auth:t.global).key(t.id).schedule(h,e,s);if(u){const t=await l;if(null!=t.data.errors&&t.data.errors.some(t=>"RATE_LIMITED"===t.type))throw Object.assign(new Error("GraphQL Rate Limit Exceeded"),{response:t,data:t.data})}return l}var a=function(){const t=`^(?:${["/orgs/{org}/invitations","/orgs/{org}/invitations/{invitation_id}","/orgs/{org}/teams/{team_slug}/discussions","/orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments","/repos/{owner}/{repo}/collaborators/{username}","/repos/{owner}/{repo}/commits/{commit_sha}/comments","/repos/{owner}/{repo}/issues","/repos/{owner}/{repo}/issues/{issue_number}/comments","/repos/{owner}/{repo}/issues/{issue_number}/sub_issue","/repos/{owner}/{repo}/issues/{issue_number}/sub_issues/priority","/repos/{owner}/{repo}/pulls","/repos/{owner}/{repo}/pulls/{pull_number}/comments","/repos/{owner}/{repo}/pulls/{pull_number}/comments/{comment_id}/replies","/repos/{owner}/{repo}/pulls/{pull_number}/merge","/repos/{owner}/{repo}/pulls/{pull_number}/requested_reviewers","/repos/{owner}/{repo}/pulls/{pull_number}/reviews","/repos/{owner}/{repo}/releases","/teams/{team_id}/discussions","/teams/{team_id}/discussions/{discussion_number}/comments"].map(t=>t.split("/").map(t=>t.startsWith("{")?"(?:.+?)":t).join("/")).map(t=>`(?:${t})`).join("|")})[^/]*$`;return new RegExp(t,"i")}(),u=a.test.bind(a),h={};function l(t,e){const{enabled:s=!0,Bottleneck:i=r,id:o="no-id",timeout:a=12e4,connection:l}=e.throttle||{};if(!s)return{};const c={timeout:a};void 0!==l&&(c.connection=l),null==h.global&&function(t,e){h.global=new t.Group({id:"octokit-global",maxConcurrent:10,...e}),h.auth=new t.Group({id:"octokit-auth",maxConcurrent:1,...e}),h.search=new t.Group({id:"octokit-search",maxConcurrent:1,minTime:2e3,...e}),h.write=new t.Group({id:"octokit-write",maxConcurrent:1,minTime:1e3,...e}),h.notifications=new t.Group({id:"octokit-notifications",maxConcurrent:1,minTime:3e3,...e})}(i,c);const d=Object.assign({clustering:null!=l,triggersNotification:u,fallbackSecondaryRateRetryAfter:60,retryAfterBaseValue:1e3,retryLimiter:new i,id:o,...h},e.throttle);if("function"!=typeof d.onSecondaryRateLimit||"function"!=typeof d.onRateLimit)throw new Error("octokit/plugin-throttling error:\n        You must pass the onSecondaryRateLimit and onRateLimit error handlers.\n        See https://octokit.github.io/rest.js/#throttling\n\n        const octokit = new Octokit({\n          throttle: {\n            onSecondaryRateLimit: (retryAfter, options) => {/* ... */},\n            onRateLimit: (retryAfter, options) => {/* ... */}\n          }\n        })\n    ");const p={},_=new i.Events(p);return p.on("secondary-limit",d.onSecondaryRateLimit),p.on("rate-limit",d.onRateLimit),p.on("error",e=>t.log.warn("Error in throttling-plugin limit handler",e)),d.retryLimiter.on("failed",async function(e,s){const[r,i,n]=s.args,{pathname:o}=new URL(n.url,"http://github.test");if((!o.startsWith("/graphql")||401===e.status)&&403!==e.status&&429!==e.status)return;const a=~~i.retryCount;i.retryCount=a,n.request.retryCount=a;const{wantRetry:u,retryAfter:h=0}=await async function(){if(/\bsecondary rate\b/i.test(e.message)){const s=Number(e.response.headers["retry-after"])||r.fallbackSecondaryRateRetryAfter;return{wantRetry:await _.trigger("secondary-limit",s,n,t,a),retryAfter:s}}if(null!=e.response.headers&&"0"===e.response.headers["x-ratelimit-remaining"]||(e.response.data?.errors??[]).some(t=>"RATE_LIMITED"===t.type)){const s=new Date(1e3*~~e.response.headers["x-ratelimit-reset"]).getTime(),r=Math.max(Math.ceil((s-Date.now())/1e3)+1,0);return{wantRetry:await _.trigger("rate-limit",r,n,t,a),retryAfter:r}}return{}}();return u?(i.retryCount++,h*r.retryAfterBaseValue):void 0}),t.hook.wrap("request",n.bind(null,d)),{}}l.VERSION="0.0.0-development",l.triggersNotification=u}},e={};function s(r){var i=e[r];if(void 0!==i)return i.exports;var n=e[r]={exports:{}};return t[r].call(n.exports,n,n.exports,s),n.exports}s.d=(t,e)=>{for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};const r=s(453),{context:i,GitHub:n}=s(733),{retry:o}=s(103),{throttling:a}=s(763),{validateAnnotationsArray:u}=s(677),{validateImagesArray:h}=s(407);r.startGroup("setup variables and client");const l=["neutral","success"],c=process.env.GITHUB_REPOSITORY.split("/")[0],d=process.env.GITHUB_REPOSITORY.split("/")[1],p=r.getInput("status"),_=r.getInput("title"),m=r.getInput("details"),g=r.getInput("summary"),f=r.getInput("conclusion"),v=r.getInput("check-run-id"),y=r.getInput("images"),w=r.getInput("annotations"),b=r.getInput("github-token"),E=n.plugin(o,a);console.log("created kit");const O=new E({auth:b,retry:{do:!0,retryAfter:30,maxRetries:5},throttle:{onRateLimit:(t,e)=>{if(O.log.warn(`Request quota exhausted for your request ${e.method} ${e.url}`),0===e.request.retryCount)return console.log(`Retrying after ${t} seconds!`),!0},onSecondaryRateLimit:(t,e)=>{if(O.log.warn(`Request quota exhausted for your secondary request ${e.method} ${e.url}`),0===e.request.retryCount)return console.log(`Secondary retrying after ${t} seconds!`),!0},onAbuseLimit:(t,e)=>{O.log.warn(`Abuse detected for your request ${e.method} ${e.url}`)}}});let k=r.getInput("name");""==k&&(r.warning("no name set, using repo name"),k=i.repo.name);const R=i.payload.pull_request;let I="";void 0!==R&&(I=R.head.sha),""!=I&&void 0!==I||(r.warning("no pull request detected, using head sha"),I=i.sha);let x=r.getInput("fail-on-neutral");""!==x?"true"===x?x=!0:("false"===x||r.warning("unknown value set for fail-on-neutral property, defaulting to false"),x=!1):(r.warning("nothing set for fail-on-neutral property, defaulting to false"),x=!1);let q=r.getInput("fail-on-error");""!==q?"true"===q?q=!0:("false"===q||r.warning("unknown value set for fail-on-error property, defaulting to false"),q=!1):(r.warning("nothing set for fail-on-error property, defaulting to false"),q=!1),r.endGroup(),async function(){r.startGroup("validate failure options"),""!==f&&(q&&!l.includes(f)&&r.setFailed("check failed for non successive state"),x&&"neutral"==f&&r.setFailed("check failed for non successive state")),r.endGroup();try{r.startGroup("construct payload");let t=0,e={owner:c,repo:d,name:k,head_sha:I,status:p,output:{title:_,summary:g,text:m}};if(""!==f&&(r.info("conclusion detected"),r.debug(f),e.conclusion=f),r.endGroup(),r.startGroup("validate annotations and images"),r.isDebug()&&r.debug(w),w){const t=JSON.parse(w),s=u(t);s.length<=0?(r.info("successfully validated annotations"),e.output.annotations=t):(r.error(s.join(" \n ")),r.debug(t),r.warning("Annotations parsing error, did not add"))}if(r.isDebug()&&r.debug(y),y){const t=JSON.parse(y);h(t).length<=0?(r.info("successfully validated images"),e.output.images=t):r.warning("Images parsing error, did not add")}r.endGroup(),r.startGroup("run command"),""===v?(r.info("creating a check run"),t=(await O.rest.checks.create(e)).data.id,r.info(`created a check run with the id of ${t}`)):(r.info("updating a check run"),e.check_run_id=v,t=(await O.rest.checks.update(e)).data.id,r.info(`updated a check run with the id of ${t}`)),r.setOutput("check-run-id",t),r.info("action was successful"),r.endGroup()}catch(t){r.error(`Error ${t}, action did not succeed`),r.endGroup()}}()})();